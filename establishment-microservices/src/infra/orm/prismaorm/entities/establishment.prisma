generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native"]
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Establishment {
  id                   String        @id @default(auto()) @map("_id") @db.ObjectId
  name                 String
  email                String        @unique
  mobileNumber         String        @unique
  subsidiary           Subsidiary[]
  password             String
  cnpj                 String
  validate_code        String?
  validate_expire_date DateTime?
  created_at           DateTime      @default(now())
  updated_at           DateTime      @default(now()) @updatedAt
  deleted_at           DateTime?
  RecoverCodes         RecoverCodes?
}

model RecoverCodes {
  token          String        @id @map("_id") @db.ObjectId
  user           Establishment @relation(fields: [userId], references: [id])
  userId         String        @unique
  expires_at     DateTime
  is_blacklisted Boolean       @default(false)
}

model Subsidiary {
  id                String        @id @default(auto()) @map("_id") @db.ObjectId
  name              String
  address           String
  addressNumber     Int
  addressComplement String?
  addressDistrict   String
  products          Products[]
  city              String
  state             String
  cep               String
  establishment     Establishment @relation(fields: [establishmentId], references: [id], onDelete: Cascade)
  establishmentId   String        @unique
}

model Products {
  id           String     @id @default(auto()) @map("_id") @db.ObjectId
  name         String
  stock        Int
  value        Float
  photo        String
  subsidiary   Subsidiary @relation(fields: [subsidiaryId], references: [id])
  subsidiaryId String     @unique
}
